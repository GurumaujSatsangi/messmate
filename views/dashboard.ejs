<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>MessMate</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Bootstrap icons-->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>
    <!-- Core theme CSS (includes Bootstrap)-->
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body>
    <!-- Responsive navbar-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container px-5">
        <a class="navbar-brand" href="#!">MessMate</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/logout"
                >Logout</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- Header-->
    <header class="bg-dark py-5">
      <div class="container px-5">
        <div class="row gx-5 justify-content-center">
          <div class="col-lg-6">
            <div class="text-center my-5">
              <h1 class="display-5 fw-bolder text-white mb-2">
                Welcome, <%= user.name %>!
              </h1>
            </div>
          </div>
        </div>
      </div>
    </header>
    <!-- Features section-->
    <section class="py-5 border-bottom" id="features">
      <div class="container px-5 my-1">
        <% if (successMessage.length > 0) { %>
        <div class="alert alert-success"><%= successMessage %></div>
        <% } %> <% if (errorMessage.length > 0) { %>
        <div class="alert alert-danger"><%= errorMessage %></div>
        <% } %>
        <h3>My Profile</h3>
        <hr />
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Hostel Type</th>
              <th>Block</th>
              <th>Mess Type</th>
              <th>Mess</th>
              <th>Update Profile</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td name="hosteltype"><%= user.hostelType %></td>
              <td name="hostel"><%= user.hostel %></td>
              <td name="messtype"><%= user.messType %></td>
              <td name="mess"><%= user.mess %></td>
              <td>
                <button
                  type="button"
                  class="btn btn-primary"
                  data-toggle="modal"
                  data-target="#exampleModal"
                >
                  <i class="bi bi-pencil-square"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
    <!--Update Profile Modal-->
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Update Profile</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="contactForm" method="POST" action="/update">
              <!-- Hostel Type Dropdown -->
              <div class="form-floating mb-3">
                <select
                  class="form-select"
                  id="hostelType"
                  name="hostelType"
                  required
                >
                  <option value="">Select Hostel Type</option>
                  <option value="Mens">Men's Hostel</option>
                  <option value="Ladies">Ladies Hostel</option>
                </select>
                <label for="hostelType">Hostel Type</label>
              </div>

              <!-- Hostel Dropdown (Conditional) -->
              <div class="form-floating mb-3">
                <select class="form-select" id="hostel" name="hostel" required>
                  <option value="">Select Hostel</option>
                </select>
                <label for="hostel">Block</label>
              </div>

              <!-- Mess Type Dropdown -->
              <div class="form-floating mb-3">
                <select
                  class="form-select"
                  id="messType"
                  name="messType"
                  required
                >
                  <option value="">Select Mess Type</option>
                  <option value="Veg">Veg</option>
                  <option value="NonVeg">Non-Veg</option>
                  <option value="Special">Special</option>
                </select>
                <label for="messType">Mess Type</label>
              </div>

              <!-- Mess Dropdown (Conditional) -->
              <div class="form-floating mb-3">
                <select class="form-select" id="mess" name="mess" required>
                  <option value="">Select Mess</option>
                </select>
                <label for="mess">Mess</label>
              </div>

              <div class="d-grid">
                <button
                  class="btn btn-primary btn-lg"
                  id="submitButton"
                  type="submit"
                >
                  Update
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="container px-5 my-5">
      <h3>Submit a Suggestion</h3>
      <hr />
      <% if (successMessage.length > 0) { %>
      <div class="alert alert-success"><%= successMessage %></div>
      <% } %> <% if (errorMessage.length > 0) { %>
      <div class="alert alert-danger"><%= errorMessage %></div>
      <% } %>
      <form id="contactForm" method="POST" action="/suggestion">
        <div class="mb-3">
          <label class="form-label d-block">Meal Type</label>
          <div class="form-check form-check-inline">
            <input
              class="form-check-input meal-checkbox"
              id="breakfast"
              type="checkbox"
              name="mealType"
            />
            <label class="form-check-label" for="breakfast">Breakfast</label>
          </div>
          <div class="form-check form-check-inline">
            <input
              class="form-check-input meal-checkbox"
              id="lunch"
              type="checkbox"
              name="mealType"
            />
            <label class="form-check-label" for="lunch">Lunch</label>
          </div>
          <div class="form-check form-check-inline">
            <input
              class="form-check-input meal-checkbox"
              id="snacks"
              type="checkbox"
              name="mealType"
            />
            <label class="form-check-label" for="snacks">Snacks</label>
          </div>
          <div class="form-check form-check-inline">
            <input
              class="form-check-input meal-checkbox"
              id="dinner"
              type="checkbox"
              name="mealType"
            />
            <label class="form-check-label" for="dinner">Dinner</label>
          </div>
        </div>

        <div id="meal-fields">
          <div class="meal-section" id="breakfast-section">
            <div class="form-floating mb-3">
              <textarea
                class="form-control"
                id="foodItemSuggestionBreakfast"
                name="breakfast"
                placeholder="Food Item Suggestion (Breakfast)"
                style="height: 10rem"
              ></textarea>
              <label for="foodItemSuggestionBreakfast"
                >Food Item Suggestion (Breakfast)</label
              >
            </div>
            <div class="mb-3">
              <label class="form-label d-block"
                >Feasible for large production?</label
              >
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="breakfastFeasible"
                  value="yes"
                />
                <label class="form-check-label">Yes</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="breakfastFeasible"
                  value="no"
                />
                <label class="form-check-label">No</label>
              </div>
            </div>
          </div>

          <div class="meal-section" id="lunch-section">
            <div class="form-floating mb-3">
              <textarea
                class="form-control"
                id="foodItemSuggestionLunch"
                name="lunch"
                placeholder="Food Item Suggestion (Lunch)"
                style="height: 10rem"
              ></textarea>
              <label for="foodItemSuggestionLunch"
                >Food Item Suggestion (Lunch)</label
              >
            </div>
            <div class="mb-3">
              <label class="form-label d-block"
                >Feasible for large production?</label
              >
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="lunchFeasible"
                  value="yes"
                />
                <label class="form-check-label">Yes</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="lunchFeasible"
                  value="no"
                />
                <label class="form-check-label">No</label>
              </div>
            </div>
          </div>

          <div class="meal-section" id="snacks-section">
            <div class="form-floating mb-3">
              <textarea
                class="form-control"
                name="snacks"
                id="foodItemSuggestionSnacks"
                placeholder="Food Item Suggestion (Snacks)"
                style="height: 10rem"
              ></textarea>
              <label for="foodItemSuggestionSnacks"
                >Food Item Suggestion (Snacks)</label
              >
            </div>
            <div class="mb-3">
              <label class="form-label d-block"
                >Feasible for large production?</label
              >
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="snacksFeasible"
                  value="yes"
                />
                <label class="form-check-label">Yes</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="snacksFeasible"
                  value="no"
                />
                <label class="form-check-label">No</label>
              </div>
            </div>
          </div>

          <div class="meal-section" id="dinner-section">
            <div class="form-floating mb-3">
              <textarea
                class="form-control"
                name="dinner"
                id="foodItemSuggestionDinner"
                placeholder="Food Item Suggestion (Dinner)"
                style="height: 10rem"
              ></textarea>
              <label for="foodItemSuggestionDinner"
                >Food Item Suggestion (Dinner)</label
              >
            </div>
            <div class="mb-3">
              <label class="form-label d-block"
                >Feasible for large production?</label
              >
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="dinnerFeasible"
                  value="yes"
                />
                <label class="form-check-label">Yes</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  class="form-check-input"
                  type="radio"
                  name="dinnerFeasible"
                  value="no"
                />
                <label class="form-check-label">No</label>
              </div>
            </div>
          </div>
        </div>
        <center>
          <div class="d-grid">
            <button
              class="btn btn-primary btn-lg"
              style="width: 18rem"
              id="submitButton"
              type="submit"
            >
              Submit
            </button>
          </div>
        </center>
      </form>
    </div>
    <section class="py-5 border-bottom" id="features">
      <div class="container px-5 my-1">
        <h3>My Suggestions</h3>
        <hr />
        <% if (results.length > 0) { %>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Breakfast</th>
              <th>Lunch</th>
              <th>Snacks</th>
              <th>Dinner</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <% results.forEach(suggestion => { %>
            <tr>
              <td><%= suggestion.breakfast %></td>
              <td><%= suggestion.lunch %></td>
              <td><%= suggestion.snacks %></td>
              <td><%= suggestion.dinner %></td>
              <td>
                <a href="/delete" class="btn btn-primary">
                  <i class="bi bi-trash"></i>
                </a>
              </td>
            </tr>
            <% }) %>
          </tbody>
        </table>
        <% } else { %>
        <p>No suggestions submitted yet.</p>
        <% } %>
      </div>
    </section>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const hostelType = document.getElementById("hostelType");
        const hostel = document.getElementById("hostel");
        const messType = document.getElementById("messType");
        const mess = document.getElementById("mess");

        const hostels = {
          Mens: [
            "MH A",
            "MH B",
            "MH B ANNEX",
            "MH C",
            "MH D",
            "MH D ANNEX",
            "MH E",
            "MH F",
            "MH G",
            "MH H",
            "MH I",
            "MH J",
            "MH J ANNEX",
            "MH K",
            "MH L",
            "MH M",
            "MH M ANNEX",
            "MH N",
            "MH N ANNEX",
            "MH P",
            "MH Q",
            "MH R",
            "MH S",
            "MH T",
          ],
          Ladies: [
            "LH A",
            "LH B",
            "LH C",
            "LH D",
            "LH E",
            "LH F",
            "LH G",
            "LH H",
            "LH J",
            "RGT H",
            "LH GH (Annex)",
          ],
        };

        const messOptions = {
          Veg: ["Zenith Veg", "SRCC Veg", "Darling Veg"],
          NonVeg: ["Zenith Non-Veg", "SRCC Non-Veg", "Darling Non-Veg"],
          Special: ["Zenith Special", "SRCC Special", "Darling Special"],
        };

        // Update hostel dropdown based on hostel type selection
        hostelType.addEventListener("change", function () {
          hostel.innerHTML = '<option value="">Select Hostel</option>'; // Reset options

          if (hostelType.value && hostels[hostelType.value]) {
            hostels[hostelType.value].forEach((hostelName) => {
              const option = document.createElement("option");
              option.value = hostelName;
              option.textContent = hostelName;
              hostel.appendChild(option);
            });
          }
        });

        // Update mess dropdown based on mess type selection
        messType.addEventListener("change", function () {
          mess.innerHTML = '<option value="">Select Mess</option>'; // Reset options

          if (messType.value && messOptions[messType.value]) {
            messOptions[messType.value].forEach((messName) => {
              const option = document.createElement("option");
              option.value = messName;
              option.textContent = messName;
              mess.appendChild(option);
            });
          }
        });
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        function toggleMealSections() {
          document.querySelectorAll(".meal-section").forEach((section) => {
            section.style.display = "none";
          });
          document
            .querySelectorAll(".meal-checkbox:checked")
            .forEach((checkbox) => {
              document.getElementById(`${checkbox.id}-section`).style.display =
                "block";
            });
        }

        document.querySelectorAll(".meal-checkbox").forEach((checkbox) => {
          checkbox.addEventListener("change", toggleMealSections);
        });

        toggleMealSections();
      });
    </script>

    <!-- Footer-->
    <footer class="py-5 bg-dark">
      <div class="container px-5">
        <p class="m-0 text-center text-white">
          Copyright &copy; MessMate. All Rights Reserved.
        </p>
      </div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>
    <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
    <!-- * *                               SB Forms JS                               * *-->
    <!-- * * Activate your form at https://startbootstrap.com/solution/contact-forms * *-->
    <!-- * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *-->
    <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
  </body>
</html>
